# Rust å…¥é—¨åˆ†äº« ğŸ¦€

---

## ä¸ºä»€ä¹ˆå­¦ä¹  Rustï¼Ÿ

-----

* è¿ç»­ä¸ƒå¹´æˆä¸ºå…¨ä¸–ç•Œæœ€å—æ¬¢è¿çš„è¯­è¨€ã€æ²¡æœ‰ GC ä¹Ÿæ— éœ€æ‰‹åŠ¨å†…å­˜ç®¡ç†
* æ€§èƒ½æ¯”è‚© C++/C è¿˜èƒ½ç›´æ¥è°ƒç”¨å®ƒä»¬çš„ä»£ç ã€å®‰å…¨æ€§æé«˜

-----

* è·¨å¹³å°ï¼Œå¯ä»¥ç¼–è¯‘ä¸ºå„ç³»ç»Ÿçš„å¯æ‰§è¡Œæ–‡ä»¶
* Rust å°†æ¥å¯èƒ½ä¼šæˆä¸º Linux å†…æ ¸å¼€å‘çš„ç¬¬äºŒè¯­è¨€

---

## ç¯å¢ƒå®‰è£…

-----

åœ¨ Linux æˆ– macOS ä¸Šå®‰è£… rust

```
$ curl --proto '=https' --tlsv1.2 https://sh.rustup.rs -sSf | sh
```

-----

åœ¨ Windows ä¸Šå®‰è£… rustï¼Œéœ€è¦ä¾èµ–äº C++ ç¯å¢ƒ

<a href="https://course.rs/first-try/installation.html#%E5%9C%A8-windows-%E4%B8%8A%E5%AE%89%E8%A3%85-rustup" target="_blank">å®‰è£…æ•™ç¨‹</a>

-----

æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ

```
$ rustc -V
rustc 1.58.0 (02072b482 2022-01-11)
```

---

## ç¼–è¾‘å™¨æ’ä»¶å®‰è£…

-----

### VSCode æ’ä»¶

-----

ğŸš« ä¸æ¨èå®˜æ–¹çš„ rust æ’ä»¶ï¼Œå·²ç»åœæ­¢ç»´æŠ¤

<img src="./images/02.png">

-----

âœ… æ›´æ¨èç”±ç¤¾åŒºé©±åŠ¨ç»´æŠ¤çš„ rust æ’ä»¶

<img src="./images/03.png">

-----

å°±åƒå…¶å®ƒè¯­è¨€æ’ä»¶ä¸€æ ·ï¼Œæä¾›äº†ä»¥ä¸‹ç‰¹æ€§ï¼š

```
1. ä»£ç è‡ªåŠ¨å®Œæˆæç¤º
2. ä»£ç é—´çš„è‡ªåŠ¨è·³è½¬
3. è¯­æ³•é«˜äº®å’Œä»£ç æ£€æŸ¥
4. ....
```

-----

### Vim æ’ä»¶

-----

```
Plugin 'rust-analyzer/rust-analyzer'
Plugin 'rust-lang/rust.vim'
```

```
let g:rustfmt_autosave = 1
```

```[7]
let g:ale_linters = {
\   'html': ['tidy'],
\   'less': ['stylelint'],
\   'javascript': ['eslint'],
\   'typescript': ['tsserver', 'eslint'],
\   'markdown': ['markdownlint'],
\   'rust': ['analyzer']
\}
```

---

## è®¤è¯† Cargo

<p class="fragment fade-up">ä¸€ä¸ªä¼˜ç§€çš„åŒ…ç®¡ç†å™¨éå¸¸é‡è¦ ğŸ“¦</p>

-----

åˆ›å»ºé¡¹ç›®

```
cargo new hello_world
```

<div class="fragment fade-up">
è¿è¡Œé¡¹ç›®

```
cargo run
```
</div>

<div class="fragment fade-up">
ç¼–è¯‘é¡¹ç›®

```shell
cargo build
```
</div>

-----

è¿è¡Œå•å…ƒæµ‹è¯•

```shell
cargo test
```

<div class="fragment fade-up">
é¡¹ç›®æ£€æŸ¥

<div style="font-size: 16px;">
å½“é¡¹ç›®å¤§äº†åï¼Œcargo run å’Œ cargo build ä¸å¯é¿å…çš„ä¼šå˜æ…¢ï¼Œå¯ä»¥æ›´å¿«çš„æ¥éªŒè¯ä»£ç çš„æ­£ç¡®æ€§
</div>

```shell
cargo check
```
</div>

---

## ä¸€ä¸ªå…¸å‹çš„ rust é¡¹ç›®ç›®å½•ç»“æ„

-----

```
.
â”œâ”€â”€ Cargo.lock
â”œâ”€â”€ Cargo.toml
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ lib.rs
â”‚   â”œâ”€â”€ main.rs
â”‚   â””â”€â”€ bin/
â”‚       â”œâ”€â”€ named-executable.rs
â”‚       â”œâ”€â”€ another-executable.rs
â”‚       â””â”€â”€ multi-file-executable/
â”‚           â”œâ”€â”€ main.rs
â”‚           â””â”€â”€ some_module.rs
â””â”€â”€ tests/
    â”œâ”€â”€ some-integration-tests.rs
    â””â”€â”€ multi-file-test/
        â”œâ”€â”€ main.rs
        â””â”€â”€ test_module.rs
```

---

## Rust æ ¸å¿ƒé…ç½®æ–‡ä»¶

-----

### Cargo.toml

```toml
[package]
name = "hello_wasm"
version = "0.1.0"
edition = "2021"

[lib]
crate-type = ["cdylib", "rlib"]

[dependencies]
wasm-bindgen = "0.2"
```

-----

### Cargo.lock

```
# This file is automatically @generated by Cargo.
# It is not intended for manual editing.
version = 3

[[package]]
name = "bumpalo"
version = "3.9.1"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "a4a45a46ab1f2412e53d3a0ade76ffad2025804294569aae387231a0cd6e0899"

[[package]]
name = "cfg-if"
version = "1.0.0"
source = "registry+https://github.com/rust-lang/crates.io-index"
checksum = "baf1de4339761588bc0619e3cbc0120ee582ebb74b53b4efbf79117bd2da40fd"

[[package]]
name = "hello_wasm"
version = "0.1.0"
dependencies = [
 "wasm-bindgen",
]
...
```

---

## ä¸‹è½½ä¾èµ–å¤ªæ…¢äº†ï¼Ÿ

---

## Rust åŸºæœ¬æ¦‚å¿µ

-----

<p style="font-size: 30px;">
ä»ç°åœ¨å¼€å§‹çœŸæ­£è¿›å…¥ rust ä¸–ç•Œï¼Œå°†æ¥è§¦åˆ°å¾ˆå¤šæ–°çš„æ¦‚å¿µ
</p>

* æ‰€æœ‰æƒã€å€Ÿç”¨ã€ç”Ÿå‘½å‘¨æœŸ
* å®ç¼–ç¨‹
* æ¨¡å¼åŒ¹é…

-----

```rust[1-2|3-6|8-9|11-14|16-17|19-20|22-25|28-32]
// Rust ç¨‹åºå…¥å£å‡½æ•°ï¼Œè·Ÿå…¶å®ƒè¯­è¨€ä¸€æ ·ï¼Œéƒ½æ˜¯ mainï¼Œè¯¥å‡½æ•°ç›®å‰æ— è¿”å›å€¼
fn main() {
   // ä½¿ç”¨letæ¥å£°æ˜å˜é‡ï¼Œè¿›è¡Œç»‘å®šï¼Œaæ˜¯ä¸å¯å˜çš„
   // æ­¤å¤„æ²¡æœ‰æŒ‡å®šaçš„ç±»å‹ï¼Œç¼–è¯‘å™¨ä¼šé»˜è®¤æ ¹æ®açš„å€¼ä¸ºaæ¨æ–­ç±»å‹ï¼ši32ï¼Œæœ‰ç¬¦å·32ä½æ•´æ•°
   // è¯­å¥çš„æœ«å°¾å¿…é¡»ä»¥åˆ†å·ç»“å°¾
   let a = 10;

   // ä¸»åŠ¨æŒ‡å®šbçš„ç±»å‹ä¸ºi32
   let b: i32 = 20;

   // è¿™é‡Œæœ‰ä¸¤ç‚¹å€¼å¾—æ³¨æ„ï¼š
   // 1. å¯ä»¥åœ¨æ•°å€¼ä¸­å¸¦ä¸Šç±»å‹:30i32è¡¨ç¤ºæ•°å€¼æ˜¯30ï¼Œç±»å‹æ˜¯i32
   // 2. cæ˜¯å¯å˜çš„ï¼Œmutæ˜¯mutableçš„ç¼©å†™
   let mut c = 30i32;

   // è¿˜èƒ½åœ¨æ•°å€¼å’Œç±»å‹ä¸­é—´æ·»åŠ ä¸€ä¸ªä¸‹åˆ’çº¿ï¼Œè®©å¯è¯»æ€§æ›´å¥½
   let d = 30_i32;

   // è·Ÿå…¶å®ƒè¯­è¨€ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼æ¥ä½œä¸ºå¦ä¸€ä¸ªå‡½æ•°çš„å‚æ•°
   let e = add(add(a, b), add(c, d));

   // println!æ˜¯å®è°ƒç”¨ï¼Œçœ‹èµ·æ¥åƒæ˜¯å‡½æ•°ä½†æ˜¯å®ƒè¿”å›çš„æ˜¯å®å®šä¹‰çš„ä»£ç å—
   // è¯¥å‡½æ•°å°†æŒ‡å®šçš„æ ¼å¼åŒ–å­—ç¬¦ä¸²è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºä¸­(æ§åˆ¶å°)
   // {}æ˜¯å ä½ç¬¦ï¼Œåœ¨å…·ä½“æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¼šæŠŠeçš„å€¼ä»£å…¥è¿›æ¥
   println!("( a + b ) + ( c + d ) = {}", e);
}

// å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥ä¸¤ä¸ªi32ç±»å‹çš„32ä½æœ‰ç¬¦å·æ•´æ•°ï¼Œè¿”å›å®ƒä»¬çš„å’Œ
fn add(i: i32, j: i32) -> i32 {
  // è¿”å›ç›¸åŠ å€¼ï¼Œè¿™é‡Œå¯ä»¥çœç•¥return
  i + j
}
```

-----

å­—ç¬¦ç±»å‹(char)

```rust
fn main() {
    let c = 'z';
    let z = 'â„¤';
    let g = 'å›½';
    let heart_eyed_cat = 'ğŸ˜»';
}
```

-----

å¸ƒå°”ç±»å‹(bool)

```rust
fn main() {
    let t = true;

    let f: bool = false; // ä½¿ç”¨ç±»å‹æ ‡æ³¨,æ˜¾å¼æŒ‡å®šfçš„ç±»å‹
}
```

-----

è¯­å¥å’Œè¡¨è¾¾å¼

```rust
fn main() {
  fn add_with_extra(x: i32, y: i32) -> i32 {
      let x = x + 1; // è¯­å¥
      let y = y + 5; // è¯­å¥
      x + y // è¡¨è¾¾å¼ã€‚ç»“å°¾æ²¡æœ‰åˆ†å·ï¼Œç›¸å½“äº return x + y;
  }
}
```

-----

å‡½æ•°

```rust
fn main() {
    another_function(5, 6.1);
}

fn another_function(x: i32, y: f32) {
    println!("The value of x is: {}", x);
    println!("The value of y is: {}", y);
}
```

---

åœ¨çº¿ç»ƒä¹ 

* <a href="https://play.rust-lang.org/" target="_blank">rust playground</a>
* <a href="https://learn.microsoft.com/zh-cn/training/paths/rust-first-steps/" target="_blank">rust å¾…åŠäº‹é¡¹å°åº”ç”¨</a>
* <a href="https://github.com/chenxiaochun/blog/blob/master/article/%E7%BC%96%E8%AF%91Rust%E4%B8%BAWebAssembly.md" target="_blank">rust webAssembly</a>

<div class="fragment zoom-in" style="margin-top: 20px;">éƒ½æ˜¯å…¥é—¨çº§ç»ƒä¹ ï¼Œåªè¦æŒ‰ç…§æ­¥éª¤åšï¼Œç»å¯¹èƒ½æˆåŠŸ âœŒï¸</div>

---

Rust å­¦ä¹ æ›²çº¿

<img src="./images/01.png" />
